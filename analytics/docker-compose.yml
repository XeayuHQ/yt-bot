version: '3.8'

services:
  # Web Analytics Dashboard
  analytics-dashboard:
    build: .
    container_name: ytbot-analytics-dashboard
    environment:
      - KAFKA_BOOTSTRAP_SERVERS=kafka:9092
    command: streamlit run dashboard.py --server.port=8501 --server.address=0.0.0.0
    ports:
      - "8501:8501"
    networks:
      - youtube-downloader-network
    restart: unless-stopped

  # Daily Report Generator (on-demand)
  daily-report:
    build: .
    container_name: ytbot-daily-report
    environment:
      - KAFKA_BOOTSTRAP_SERVERS=kafka:9092
    command: python daily_report.py 24
    networks:
      - youtube-downloader-network
    volumes:
      - ./reports:/app/reports
    profiles:
      - report

networks:
  youtube-downloader-network:
    external: true
    name: ytbot_youtube-downloader-network
